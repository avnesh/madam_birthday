<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fun Zone - Madam</title>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="min-h-screen font-poppins">
<!-- Moving Background Particles -->
<div class="particles">
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
  <div class="particle"></div>
</div>
  <nav class="p-4 container mx-auto flex justify-between items-center relative">
    <!-- Hamburger Button (Mobile Only) -->
    <button id="hamburger-btn" class="md:hidden z-50">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
    </button>

    <!-- Navigation Links (Mobile Menu & Desktop) -->
    <div class="hidden md:flex md:items-center md:space-x-4"><a href="memories.html">Memories</a><a href="wishes.html">Wishes</a><a href="surprise.html">Surprise</a></div>
    <a href="index.html" class="text-sm font-bold z-20">Home</a>
  </nav>

  <!-- Mobile Menu - MOVED HERE -->
  <div id="nav-links" class="hidden mobile-nav"><a href="memories.html">Memories</a><a href="wishes.html">Wishes</a><a href="surprise.html">Surprise</a></div>

  <main class="container mx-auto p-6 text-center">
    <h2 class="text-3xl font-semibold script-heading">Fun Zone</h2>
    <p class="mt-2 text-gray-600">Pop at least 3 balloons or reveal 3 hearts to unlock the next page.</p>
    <div id="progressTracker" class="mt-4 text-gray-700 font-semibold">
      Balloons Popped: 0 | Hearts Revealed: 0
    </div>

    <section class="mt-6">
      <div id="balloonArea" class="balloon-area">
        <div id="wishPopContainer"></div>
      </div>
      <div class="mt-6 space-x-3">
        <button id="startBalloons" class="btn-primary">Spawn Balloons</button>
      </div>
    </section>

    <hr class="my-8 border-pink-300"/>

    <section>
      <h3 class="text-2xl script-heading">Heart Reveal</h3>
      <p class="mt-2 text-gray-600">Click each heart to reveal a message inside.</p>
      <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-4" id="heartGrid">
        </div>
    </section>

    <div class="mt-8">
      <a id="afterFunNext" href="#" class="btn-primary opacity-50 pointer-events-none">Next Page: Surprise</a>
    </div>
  </main>

  <audio id="bgAudio" src="assets/music/birthday.mp3"></audio>
  <script src="script.js"></script>
  <script>
    document.getElementById('startBalloons').addEventListener('click', () => spawnBalloons(6));
    
    // Element to display the persistent message
    const wishPopContainer = document.getElementById('wishPopContainer');

    let balloonsPopped = 0;
    const requiredBalloons = 3;
    let heartsRevealed = 0;
    const wishes = [
      'You are cherished üíñ',
      'May your smile bloom forever ‚ú®',
      'Your kindness lights the way üåπ',
      'Endless joy and peace to you üå∏',
      'Stay graceful and strong üåü',
      'Keep shining bright üí´'
    ];
    const balloonColors = [
      'balloon-color-1', 
      'balloon-color-2', 
      'balloon-color-3', 
      'balloon-color-4',
      'balloon-color-5',
      'balloon-color-6'
    ];

    function spawnBalloons(n){
      // Clear previous message on new spawn
      balloonsPopped = 0; // Reset balloon count on new spawn
      updateProgressTracker();
      wishPopContainer.innerHTML = '';
      
      const area = document.getElementById('balloonArea');
      const existingBalloons = area.querySelectorAll('.balloon');
      existingBalloons.forEach(b => b.remove());
      
      for(let i=0;i<n;i++){
        const b = document.createElement('div');
        const colorClass = balloonColors[i % balloonColors.length];
        const stringHtml = `<div class="balloon-string"></div>`; 
        
        b.className = 'balloon ' + colorClass;
        // MOBILE FIX: Adjust horizontal spacing to prevent overlap on mobile
        // This formula centers the balloons and ensures they are all visible.
        const spacing = 100 / n;
        b.style.left = (spacing * (i + 0.5)) + '%';
        // Start lower to allow for greater ascent
        b.style.bottom = '-' + (Math.random() * 50 + 10) + 'px'; 
        b.style.animationDelay = (i * 0.4) + 's';
        b.innerHTML = stringHtml;
        
        b.addEventListener('click', ()=>{
          popBalloon(b, i);
        });
        area.appendChild(b);
      }
    }
    
    function popBalloon(el, idx){
      if(el.classList.contains('pop')) return;
      
      const wish = wishes[idx % wishes.length];

      // 1. Clear previous message and display the new one persistently at the top
      wishPopContainer.innerHTML = `<div class="wish-pop">${wish}</div>`;

      // 2. Pop the balloon (remove the balloon entirely)
      el.classList.add('pop');
      el.removeEventListener('click', popBalloon);
      setTimeout(() => el.remove(), 300);
      balloonsPopped++;
      updateProgressTracker();
      checkCompletion();
    }

    // Heart reveal logic (Message appears inside the button)
    const heartMessages = [
      'You are the reason for my smile.',
      'Always stay as beautiful as you are.',
      'Every moment with you is a gift.',
      'Wishing you endless love and happiness.',
      'Your heart is made of gold.',
      'Forever grateful for you.'
    ];

    const heartGrid = document.getElementById('heartGrid');
    heartGrid.innerHTML = ''; 

    for(let i=0;i<6;i++){
      const h = document.createElement('button');
      h.className = 'heart-btn';
      h.innerHTML = `<span class="heart-icon">‚ùì</span>`;
      h.dataset.msg = heartMessages[i];
      h.addEventListener('click', function() {
        if(this.classList.contains('revealed')) return;

        this.classList.add('revealed');
        // Inject message directly into the button
        this.innerHTML = `<span class="heart-message-overlay">${this.dataset.msg}</span>`;
        
        heartsRevealed++;
        updateProgressTracker();
        checkCompletion();
      });
      heartGrid.appendChild(h);
    }

    function checkCompletion(){
      if(heartsRevealed >= 3 || balloonsPopped >= requiredBalloons) {
          enableNext();
      }
    }

    function updateProgressTracker() {
      document.getElementById('progressTracker').textContent = `Balloons Popped: ${balloonsPopped} | Hearts Revealed: ${heartsRevealed}`;
    }

    function enableNext(){
      const a = document.getElementById('afterFunNext');
      a.classList.remove('opacity-50','pointer-events-none');
      a.href = 'surprise.html';
    }
    function disableNext(){
      const a = document.getElementById('afterFunNext');
      a.classList.add('opacity-50','pointer-events-none');
      a.href = '#';
    }
    
    document.addEventListener('DOMContentLoaded', disableNext);
  </script>
</body>
</html>